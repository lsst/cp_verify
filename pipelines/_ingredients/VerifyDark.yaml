description: cp_verify DARK calibration verification
tasks:
  verifyDarkApply:
    class: lsst.ip.isr.isrTask.IsrTask
    config:
      connections.ccdExposure: 'raw'
      connections.outputExposure: 'verifyDarkProc'
      # Disable downstream processing.
      overscan.fitType: 'MEDIAN_PER_ROW'
      doDark: true
      doFlat: false
      doApplyGains: false
      doFringe: false
      doCalculateStatistics: true
      isrStats.doCopyCalibDistributionStatistics: true
      doBinnedExposures: true
      binFactor1: 8
      binFactor2: 64
  verifyDarkChip:
    class: lsst.cp.verify.CpVerifyDarkTask
    config:
      connections.inputExp: 'verifyDarkProc'
      connections.taskMetadata: 'verifyDarkApply_metadata'
      connections.outputStats: 'verifyDarkDetStats'
      connections.outputResults: 'verifyDarkDetResults'
      useIsrStatistics: true
  verifyDarkExp:
    class: lsst.cp.verify.CpVerifyExpMergeTask
    config:
      connections.inputStats: 'verifyDarkDetStats'
      connections.inputResults: 'verifyDarkDetResults'
      connections.outputStats: 'verifyDarkExpStats'
      connections.outputResults: 'verifyDarkExpResults'
      hasInputResults: true
      hasMatrixCatalog: false
  verifyDark:
    class: lsst.cp.verify.CpVerifyRunMergeTask
    config:
      connections.inputStats: 'verifyDarkExpStats'
      connections.inputResults: 'verifyDarkExpResults'
      connections.outputStats: 'verifyDarkStats'
      connections.outputResults: 'verifyDarkResults'
      hasInputResults: true
      hasMatrixCatalog: false
  mosaicExp1:
    class: lsst.pipe.tasks.visualizeVisit.VisualizeMosaicExpTask
    config:
      connections.inputExp: 'postIsrBin1'
      connections.outputExp: 'verifyDarkMosaic1'
      binning: 8
  mosaicExp2:
    class: lsst.pipe.tasks.visualizeVisit.VisualizeMosaicExpTask
    config:
      connections.inputExp: 'postIsrBin2'
      connections.outputExp: 'verifyDarkMosaic2'
      binning: 64
contracts:
  - verifyDarkApply.binFactor1 == mosaicExp1.binning
  - verifyDarkApply.binFactor2 == mosaicExp2.binning
